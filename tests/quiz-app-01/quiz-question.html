<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상식 퀴즈 챌린지</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'fade-in': 'fadeIn 0.5s ease-out'
                    },
                    keyframes: {
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .progress-bar {
            transition: width 0.3s ease-in-out;
        }
        .gradient-background {
            background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-100 via-pink-50 to-blue-100">
    <!-- 진행바 -->
    <div class="fixed top-0 left-0 w-full h-3 bg-gray-200 z-50">
        <div id="progress" class="progress-bar h-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-r-full" style="width: 0%"></div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-2xl">
       <!-- 질문 컨테이너 부분 -->
<div id="questionContainer" class="mt-8 animate-fade-in">
    <div class="text-center mb-8">
        <span class="inline-block px-4 py-2 rounded-full bg-white shadow-lg text-purple-600 font-bold animate-bounce-slow" id="questionNumber">1/20</span>
    </div>
    
    <div class="bg-white rounded-2xl p-8 shadow-lg mb-8 transform hover:scale-102 transition duration-300">
        <h2 id="questionText" class="text-xl md:text-2xl font-bold text-center leading-relaxed break-keep text-gray-800">
            질문이 여기에 표시됩니다
        </h2>
        <p id="questionContext" class="mt-4 text-center text-gray-600 text-sm md:text-base leading-relaxed break-keep">
            부가설명이 여기에 표시됩니다
        </p>
    </div>

    <!-- 답변 버튼 컨테이너 -->
    <div class="space-y-4" id="answersContainer">
        <!-- 답변 버튼들이 여기에 동적으로 생성됨 -->
    </div>
</div>

<!-- 장식 요소들 -->
<div class="fixed top-20 left-10 w-12 h-12 bg-purple-400 rounded-full opacity-50 animate-bounce-slow"></div>
<div class="fixed bottom-20 right-10 w-8 h-8 bg-pink-400 rounded-full opacity-50 animate-wiggle"></div>

<script type="module">
    import quizDataSets from './quizDataSets.js';
    
    // 전역 변수 선언
    let quizData;
    let currentQuestion = 0;
    let scores = [];
    let userScore = 0;

    // DOM 요소 참조
    const questionNumber = document.getElementById('questionNumber');
    const questionText = document.getElementById('questionText');
    const questionContext = document.getElementById('questionContext');
    const progress = document.getElementById('progress');
    const answersContainer = document.getElementById('answersContainer');

    function updateQuestion() {
        const current = quizData[currentQuestion];
        questionNumber.textContent = `${currentQuestion + 1}/${quizData.length}`;
        questionText.textContent = current.question;
        questionContext.textContent = current.context || '';
        progress.style.width = `${(currentQuestion / quizData.length) * 100}%`;
        
        updateAnswerButtons(current.options);
    }

    function updateAnswerButtons(options) {
        answersContainer.innerHTML = ''; // 기존 버튼들 제거
        
        options.forEach((option, index) => {
            const button = document.createElement('button');
            button.className = `w-full p-5 rounded-xl border-2 border-transparent hover:border-purple-400 transition-all duration-300 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold shadow-md hover:shadow-xl transform hover:-translate-y-1 answer-btn`;
            
            button.innerHTML = `
                <div class="flex items-center space-x-3">
                    <span class="text-xl">${getEmoji(index)}</span>
                    <span class="flex-1 text-left leading-relaxed break-keep">${option}</span>
                </div>
            `;
            
            button.addEventListener('click', () => {
                const current = quizData[currentQuestion];
                handleAnswer(option === current.correct ? 10 : 0);
            });
            
            answersContainer.appendChild(button);
        });
    }

    function getEmoji(index) {
        const emojis = ['✨', '💫', '⭐', '🌟'];
        return emojis[index] || '☀️';
    }

    function handleAnswer(score) {
        scores.push(score);
        userScore += score;
        
        if (currentQuestion < quizData.length - 1) {
            currentQuestion++;
            updateQuestion();
        } else {
            saveScoreToLocalStorage();
            window.location.href = `quiz-result.html?score=${userScore}`;
        }
    }

    function saveScoreToLocalStorage() {
        let scoresData = JSON.parse(localStorage.getItem('quizScores') || '[]');
        scoresData.push({ score: userScore, time: new Date().getTime() });
        localStorage.setItem('quizScores', JSON.stringify(scoresData));
    }

    // 페이지 로드 시 초기화
    document.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const setNumber = urlParams.get('set');
        
        if (!quizDataSets[`set${setNumber}`]) {
            console.error('Invalid quiz set:', setNumber);
            return;
        }
        
        quizData = quizDataSets[`set${setNumber}`].questions;
        updateQuestion();
    });
</script>  
<style>
    /* 추가 스타일 */
    .break-keep {
        word-break: keep-all; /* 한글 단어 단위 줄바꿈 */
        overflow-wrap: break-word; /* 긴 영문도 자연스럽게 줄바꿈 */
    }

    /* 모바일에서의 텍스트 크기 조정 */
    @media (max-width: 640px) {
        #questionText {
            font-size: 1.25rem;
            line-height: 1.75rem;
        }
        #questionContext {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }
    }

    /* 질문 컨테이너 애니메이션 */
    .question-transition {
        transition: all 0.3s ease-in-out;
    }

    /* 질문 컨테이너 여백 최적화 */
    .question-container {
        max-width: 100%;
        margin: 0 auto;
        padding: 1rem;
    }

    /* 긴 텍스트를 위한 스크롤 방지 */
    .no-scroll-container {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3; /* 최대 3줄까지 표시 */
        -webkit-box-orient: vertical;
    }

    /* 버튼 호버 효과 개선 */
    .answer-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }

    /* 버튼 클릭 효과 */
    .answer-btn:active {
        transform: translateY(0);
        box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    }
</style>
</body>
</html>
