<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상식 입문 - 질문</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../../css/question.css">
</head>
<body class="bg-gradient-to-br from-slate-100 to-blue-50 min-h-screen">
    <!-- 진행바 -->
    <div class="fixed top-0 left-0 w-full h-2 bg-gray-800 z-50">
        <div id="progress" class="progress-bar h-full cyber-gradient" style="width: 0%"></div>
    </div>

    <!-- 질문 컨테이너 -->
   <div class="min-h-screen flex items-center justify-center px-4 py-20">
    <div id="questionContainer" class="question-container w-full max-w-2xl">            
        <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-xl mb-8 neon-border">
            <h2 id="questionText" class="text-xl md:text-2xl font-bold text-center mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                질문이 여기에 표시됩니다
            </h2>
            <p id="questionContext" class="text-center text-gray-600 text-sm md:text-base">
                부가설명이 여기에 표시됩니다
            </p>
            </div>

            <!-- 답변 버튼들 -->
            <div id="options" class="options"></div>

            <!-- 정답 및 점수 표시 -->
            <div id="answer-feedback" class="hidden mt-4">
                <p id="correct-answer" class="correct-answer"></p>
                <p id="current-score" class="current-score"></p>
            </div>

            <!-- 다음 버튼 -->
            <button id="next-button" class="hidden mt-4 w-full p-5 rounded-xl border-2 border-transparent transition-all duration-300 bg-gradient-to-r from-green-500 to-blue-500 text-white font-bold shadow-lg hover:shadow-xl transform hover:-translate-y-1" onclick="nextQuestion()">다음</button>
        </div>
    </div>

    <script type="module">
        import quizDataSets from './quizDataSets.js';

        const currentQuiz = quizDataSets.set7;
        let currentQuestionIndex = 0;
        let score = 0;

        const questionContainer = document.getElementById('questionContainer');
        const questionText = document.getElementById('questionText');
        const questionContext = document.getElementById('questionContext');
        const progress = document.getElementById('progress');
        const answerFeedback = document.getElementById('answer-feedback');
        const correctAnswerElement = document.getElementById('correct-answer');
        const currentScoreElement = document.getElementById('current-score');
        const nextButton = document.getElementById('next-button');
        const optionsElement = document.getElementById('options');

        function loadQuestion() {
            const currentQuestion = currentQuiz.questions[currentQuestionIndex];

            // Reset animation
            questionContainer.style.animation = 'none';
            questionContainer.offsetHeight; // Trigger reflow
            questionContainer.style.animation = null;

            // Update question text and context
            questionText.textContent = currentQuestion.question;
            questionContext.textContent = currentQuestion.context || ''; // Update if you have context

            // Update progress bar
            const progressPercentage = (currentQuestionIndex / currentQuiz.questions.length) * 100;
            progress.style.width = `${progressPercentage}%`;

            // Hide answer feedback and next button
            answerFeedback.classList.add('hidden');
            nextButton.classList.add('hidden');

            // Apply slide-in animation
            questionContainer.style.animation = 'slideIn 0.5s ease-out';

            // Clear existing options
            optionsElement.innerHTML = '';

            // Create new option buttons
            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.innerText = option;
                button.classList.add('option'); // option 클래스 추가
                button.addEventListener('click', () => checkAnswer(option));
                optionsElement.appendChild(button);
            });
        }

        function checkAnswer(selectedOption) {
            const currentQuestion = currentQuiz.questions[currentQuestionIndex];

            const isCorrect = selectedOption === currentQuestion.correct;

            // Update score if the answer is correct
            if (isCorrect) {
                score++;
            }

            // Show correct answer and current score
            correctAnswerElement.textContent = `정답: ${currentQuestion.correct}`;
            currentScoreElement.textContent = `현재 점수: ${score} / ${currentQuiz.questions.length}`;
            answerFeedback.classList.remove('hidden');

            // Show next button
            nextButton.classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuestionIndex++;

            if (currentQuestionIndex < currentQuiz.questions.length) {
                loadQuestion();
            } else {
                // 퀴즈 종료, 점수 저장 및 결과 페이지로 이동
                localStorage.setItem('userScore', score);
                window.location.href = './result.html';
            }
        }

        // Load the first question
        loadQuestion();
    </script>
</body>
</html>
