<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í€´ì¦ˆ ê²°ê³¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./css/result.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>
<body class="bg-gradient-to-br from-slate-100 to-blue-50 min-h-screen">
    <div class="min-h-screen flex items-center justify-center px-4 py-12">
        <div class="result-container animate-fadeIn">
            <!-- ì ìˆ˜ í‘œì‹œ -->
            <div class="score-section mb-8">
                <h1 class="text-4xl font-bold bg-gradient-to-r from-violet-500 to-fuchsia-500 bg-clip-text text-transparent mb-4">
                    ğŸ‰ í€´ì¦ˆ ì™„ë£Œ!
                </h1>
                <div id="score-display" class="text-2xl mb-4">
                    <span class="font-bold text-indigo-600">ë‹¹ì‹ ì˜ ì ìˆ˜ëŠ”</span>
                    <span id="score" class="text-3xl font-bold text-purple-600"></span>
                </div>
                <div id="badge-container" class="mt-4">
                    <!-- ë±ƒì§€ ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- í†µê³„ ì„¹ì…˜ -->
            <div class="stats-section bg-white/80 backdrop-blur-sm rounded-xl p-6 mb-8">
                <p class="text-lg mb-2">
                    ğŸ® í˜„ì¬ê¹Œì§€ <span id="total-players" class="font-bold text-indigo-600"></span>ëª…ì´ ë„ì „!
                </p>
                <p class="text-lg">
                    ğŸ† ë‹¹ì‹ ì˜ ìˆœìœ„: ìƒìœ„ <span id="rank-percentage" class="font-bold text-purple-600"></span>%
                </p>
            </div>

            <!-- ìƒì„¸ ë¶„ì„ í† ê¸€ ë²„íŠ¼ -->
            <button id="analysis-toggle" class="w-full p-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl mb-6 hover:shadow-lg transition-all">
                ğŸ“Š ìƒì„¸ ë¶„ì„ ë³´ê¸°
            </button>

            <!-- ìƒì„¸ ë¶„ì„ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
            <div id="detailed-analysis" class="hidden bg-white/90 backdrop-blur-sm rounded-xl p-6 mb-8">
                <div class="analysis-content">
                    <!-- ë¶„ì„ ë‚´ìš©ì€ JavaScriptë¡œ ë™ì  ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì¶”ì²œ í€´ì¦ˆ ì„¹ì…˜ -->
            <div class="recommendations-section bg-white/90 backdrop-blur-sm rounded-xl p-6 mb-8">
                <h3 class="text-xl font-bold mb-4 text-indigo-600">ğŸ“š ë‹¤ìŒ ë‹¨ê³„ ì¶”ì²œ</h3>
                <div id="quiz-recommendations" class="grid grid-cols-2 gap-4">
                    <!-- ì¶”ì²œ í€´ì¦ˆ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì•¡ì…˜ ë²„íŠ¼ -->
            <div class="action-buttons grid grid-cols-2 gap-4">
                <a href="index.html" class="btn-secondary">
                    ğŸ  í™ˆìœ¼ë¡œ
                </a>
                <a id="retry-button" href="#" class="btn-primary">
                    ğŸ”„ ë‹¤ì‹œ ë„ì „
                </a>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ê²°ê³¼ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const score = parseInt(localStorage.getItem('userScore') || 0);
            const totalQuestions = parseInt(localStorage.getItem('totalQuestions') || 0);
            const quizNumber = localStorage.getItem('quizNumber') || '7';
            const totalPlayers = parseInt(localStorage.getItem('totalPlayers') || 23456);

            // ì ìˆ˜ í‘œì‹œ
            document.getElementById('score').textContent = ` ${score}/${totalQuestions}`;

            // ë°©ë¬¸ì ìˆ˜ í‘œì‹œ
            document.getElementById('total-players').textContent = totalPlayers.toLocaleString();

            // ë­í‚¹ ê³„ì‚° (ì˜ˆì‹œ - ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•œ ë¡œì§ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤)
            const percentage = Math.round((score / totalQuestions) * 100);
            const rankPercentage = 100 - percentage + Math.floor(Math.random() * 20);
            document.getElementById('rank-percentage').textContent = rankPercentage;

            // ë±ƒì§€ ë° ë©”ì‹œì§€ ì„¤ì •
            let badge, title, message;
            if (percentage >= 90) {
                badge = "ğŸŒŸ";
                title = "ìƒì‹ ì´ˆì›”ì";
                message = "ë†€ë¼ìš´ ì‹¤ë ¥ì´ì—ìš”! ë‹¹ì‹ ì€ ì§„ì •í•œ í€´ì¦ˆ ë§ˆìŠ¤í„°ì…ë‹ˆë‹¤!";
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            } else if (percentage >= 70) {
                badge = "ğŸ“";
                title = "ì§€ì‹ í˜„ì";
                message = "í›Œë¥­í•´ìš”! ë‹¹ì‹ ì˜ ì§€ì‹ì´ ë¹›ë‚˜ê³  ìˆì–´ìš”!";
            } else if (percentage >= 50) {
                badge = "ğŸš€";
                title = "ì§„ë¦¬ íƒí—˜ê°€";
                message = "ì¢‹ì€ ì‹œë„ì˜€ì–´ìš”! ê³„ì† ë„ì „í•˜ë©´ ë” ì¢‹ì€ ê²°ê³¼ê°€ ìˆì„ ê±°ì˜ˆìš”!";
            } else if (percentage >= 30) {
                badge = "ğŸ’";
                title = "ì§€í˜œ ìˆ˜ì§‘ê°€";
                message = "ê´œì°®ì•„ìš”! ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆëë‹ˆë‹¤!";
            } else {
                badge = "ğŸŒ±";
                title = "í˜¸ê¸°ì‹¬ ìƒˆì‹¹";
                message = "ë„ì „í•˜ì‹  ê²ƒë§Œìœ¼ë¡œë„ ë©‹ì ¸ìš”! ë‹¤ìŒì—” ë” ì˜í•  ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!";
            }

            // ë±ƒì§€ í‘œì‹œ
            document.getElementById('badge-container').innerHTML = `
                <div class="text-4xl mb-2">${badge}</div>
                <div class="text-xl font-bold text-indigo-600">${title}</div>
                <div class="text-gray-600 mt-2">${message}</div>
            `;

            // ìƒì„¸ ë¶„ì„ í† ê¸€
            const analysisToggle = document.getElementById('analysis-toggle');
            const detailedAnalysis = document.getElementById('detailed-analysis');
            const analysisContent = document.querySelector('.analysis-content');

            analysisToggle.addEventListener('click', () => {
                detailedAnalysis.classList.toggle('hidden');
                if (!detailedAnalysis.classList.contains('hidden')) {
                    analysisContent.innerHTML = `
                        <div class="mb-4">
                            <h4 class="font-bold text-lg mb-2">ğŸ’« ê°•ì </h4>
                            <p class="text-gray-600">ë¹ ë¥¸ íŒë‹¨ë ¥ê³¼ ì§ê´€ì ì¸ ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ì´ ë‹ë³´ì…ë‹ˆë‹¤.</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-bold text-lg mb-2">ğŸ“ˆ ì„±ì¥ í¬ì¸íŠ¸</h4>
                            <p class="text-gray-600">ë¬¸ì œë¥¼ ì¢€ ë” ì²œì²œíˆ ì½ê³  ì‹ ì¤‘í•˜ê²Œ ì ‘ê·¼í•´ë³´ì„¸ìš”.</p>
                        </div>
                        <div>
                            <h4 class="font-bold text-lg mb-2">ğŸ¯ ë‹¤ìŒ ëª©í‘œ</h4>
                            <p class="text-gray-600">í˜„ì¬ ì ìˆ˜ë³´ë‹¤ 10% í–¥ìƒì„ ëª©í‘œë¡œ í•´ë³´ì„¸ìš”!</p>
                        </div>
                    `;
                }
            });

            // ë‹¤ìŒ í€´ì¦ˆ ì¶”ì²œ
            const recommendationsContainer = document.getElementById('quiz-recommendations');
            const nextQuizNumber = parseInt(quizNumber) + 1;
            const prevQuizNumber = parseInt(quizNumber) - 1;

            if (prevQuizNumber >= 7) {
                recommendationsContainer.innerHTML += `
                    <a href="question.html?quiz=${prevQuizNumber}" target="_blank" class="recommendation-btn">
                        â¬…ï¸ í€´ì¦ˆ ${prevQuizNumber}
                    </a>
                `;
            }
            
            if (nextQuizNumber <= 18) {
                recommendationsContainer.innerHTML += `
                    <a href="question.html?quiz=${nextQuizNumber}" target="_blank" class="recommendation-btn">
                        í€´ì¦ˆ ${nextQuizNumber} â¡ï¸
                    </a>
                `;
            }

            // ì¬ë„ì „ ë²„íŠ¼ ì„¤ì •
            document.getElementById('retry-button').href = `question.html?quiz=${quizNumber}`;
        });
    </script>
</body>
</html>
